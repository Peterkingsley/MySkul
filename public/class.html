<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classes - Local Data</title>
    <!-- Use Tailwind CSS for rapid styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Customizing the Tailwind theme to match the UI's color palette
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dark-bg': '#191A23',
                        'dark-card': '#252733',
                        'dark-border': '#3D3D4E',
                        'dark-text': '#A8A8B3',
                        'dark-text-bold': '#E5E5E5',
                        'brand-purple': '#5A63F8',
                        'brand-blue': '#407BFF',
                        'brand-teal': '#28B7A5',
                        'brand-orange': '#FF7C40',
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom CSS for body and animations */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #191A23;
            color: #E5E5E5;
        }
        /* Style for the mobile menu button */
        .mobile-menu-button {
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 50;
        }
    </style>
</head>
<body class="bg-dark-bg min-h-screen font-sans text-dark-text-bold">

    <!-- Mobile Menu Button -->
    <button id="mobileMenuButton" class="lg:hidden mobile-menu-button p-2 text-dark-text-bold rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-purple">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </button>
    
    <!-- Main content container using flexbox for desktop layout -->
    <div class="flex flex-col lg:flex-row min-h-screen">
        <!-- Sidebar -->
        <aside id="sidebar" class="bg-dark-card w-64 p-4 flex flex-col justify-between transition-transform duration-300 ease-in-out transform -translate-x-full lg:translate-x-0 fixed lg:relative lg:flex-shrink-0 inset-y-0 left-0 z-40 border-r border-dark-border">
            <!-- Logo and Navigation -->
            <div>
                <!-- Logo -->
                <div class="mb-4 flex items-center space-x-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-brand-purple" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                    <h1 class="text-xl font-bold text-dark-text-bold">EduDash</h1>
                </div>
                
                <!-- Navigation Links -->
                <nav>
                    <ul>
                        <li><a href="dashboard.html" class="flex items-center space-x-3 p-3 rounded-xl font-medium text-dark-text hover:bg-dark-border transition-colors duration-200 mb-2"><span>Dashboard</span></a></li>
                        <li><a href="students.html" class="flex items-center space-x-3 p-3 rounded-xl font-medium text-dark-text hover:bg-dark-border transition-colors duration-200 mb-2"><span>Students</span></a></li>
                        <li><a href="class.html" class="flex items-center space-x-3 p-3 rounded-xl font-semibold text-white bg-brand-purple hover:bg-brand-purple/80 transition-colors duration-200 mb-2"><span>Classes</span></a></li>
                        <li><a href="attendance.html" class="flex items-center space-x-3 p-3 rounded-xl font-medium text-dark-text hover:bg-dark-border transition-colors duration-200 mb-2"><span>Attendance</span></a></li>
                    </ul>
                </nav>
            </div>
            
            <!-- User Profile/Logout -->
            <div class="pt-4 border-t border-dark-border">
                <a href="index.html" class="flex items-center space-x-3 p-3 rounded-xl font-medium text-dark-text hover:bg-dark-border transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10 22H5a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h5"></path>
                        <polyline points="17 16 21 12 17 8"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    <span>Logout</span>
                </a>
            </div>
        </aside>

        <!-- Main Content Area: Responsive and scrollable -->
        <main class="flex-1 p-4 overflow-y-auto transition-all duration-300 ease-in-out">
            
            <!-- Class List View -->
            <div id="classListContainer" class="block">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold">Classes</h2>
                </div>

                <!-- Search and Filter -->
                <div class="mb-4">
                    <input type="text" id="classSearch" placeholder="Search classes..." class="w-full p-2 rounded-lg bg-dark-card border border-dark-border focus:outline-none focus:ring-2 focus:ring-brand-purple">
                </div>

                <!-- Classes Table -->
                <div class="bg-dark-card rounded-xl border border-dark-border overflow-x-auto">
                    <table class="w-full text-left">
                        <thead>
                            <tr class="text-dark-text">
                                <th class="py-3 px-4">Class Name</th>
                                <th class="py-3 px-4">Teacher</th>
                                <th class="py-3 px-4">Number of Students</th>
                                <th class="py-3 px-4">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="classTableBody">
                            <!-- Class rows will be populated by script -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Class Details View -->
            <div id="classDetailsContainer" class="hidden">
                <div class="flex justify-between items-center mb-4">
                    <h2 id="classDetailTitle" class="text-2xl font-bold">Class Details</h2>
                    <div class="flex space-x-2">
                        <button id="backToClassesButton" class="p-2 bg-dark-border rounded-lg text-dark-text-bold hover:bg-dark-border/80 transition-colors duration-200">
                            Back to Classes
                        </button>
                    </div>
                </div>
                <div class="bg-dark-card p-6 rounded-xl border border-dark-border space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <h3 class="font-bold text-dark-text-bold">Assigned Teacher</h3>
                            <p id="classTeacher" class="text-dark-text"></p>
                        </div>
                        <div class="space-y-2">
                            <h3 class="font-bold text-dark-text-bold">Number of Students</h3>
                            <p id="classStudentCount" class="text-dark-text"></p>
                        </div>
                    </div>
                    
                    <!-- Class Stats -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div class="p-4 bg-dark-bg rounded-xl border border-dark-border">
                            <h3 class="text-lg font-bold mb-2">Overall Top Student</h3>
                            <div class="text-brand-teal text-3xl font-bold" id="overallTopStudentName"></div>
                            <p class="text-dark-text text-sm">Average Grade: <span id="overallTopStudentGrade" class="text-brand-teal"></span></p>
                        </div>
                        <div class="p-4 bg-dark-bg rounded-xl border border-dark-border">
                            <h3 class="text-lg font-bold mb-2">Top in Homework</h3>
                            <div class="text-brand-blue text-3xl font-bold" id="topHomeworkStudentName"></div>
                            <p class="text-dark-text text-sm">Average Score: <span id="topHomeworkStudentScore" class="text-brand-blue"></span></p>
                        </div>
                        <div class="p-4 bg-dark-bg rounded-xl border border-dark-border">
                            <h3 class="text-lg font-bold mb-2">Best Attendance</h3>
                            <div class="text-brand-purple text-3xl font-bold" id="topAttendanceStudentName"></div>
                            <p class="text-dark-text text-sm">Attendance Rate: <span id="topAttendanceStudentRate" class="text-brand-purple"></span></p>
                        </div>
                    </div>
                    
                    <h3 class="text-xl font-bold mt-6 mb-4">Students in Class</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead>
                                <tr class="text-dark-text">
                                    <th class="py-3 px-4">Student Name</th>
                                    <th class="py-3 px-4">ID</th>
                                </tr>
                            </thead>
                            <tbody id="classStudentList">
                                <!-- Student list will be dynamically populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </main>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Local Data Source (JSON Object) ---
            const classData = {
                '1': {
                    name: 'Grade 5 - A',
                    teacher: 'Ms. Smith',
                    students: [
                        { id: 'S-001', name: 'Emily White' },
                        { id: 'S-002', name: 'Michael Brown' },
                        { id: 'S-003', name: 'Sophia Davis' }
                    ],
                    stats: {
                        overallTopStudent: { name: 'Emily White', grade: '95%' },
                        topHomeworkStudent: { name: 'Michael Brown', score: '98%' },
                        topAttendanceStudent: { name: 'Sophia Davis', rate: '99%' }
                    }
                },
                '2': {
                    name: 'Grade 6 - B',
                    teacher: 'Mr. Johnson',
                    students: [
                        { id: 'S-004', name: 'Liam Wilson' },
                        { id: 'S-005', name: 'Olivia Taylor' }
                    ],
                    stats: {
                        overallTopStudent: { name: 'Olivia Taylor', grade: '92%' },
                        topHomeworkStudent: { name: 'Olivia Taylor', score: '96%' },
                        topAttendanceStudent: { name: 'Liam Wilson', rate: '97%' }
                    }
                },
                '3': {
                    name: 'Grade 7 - C',
                    teacher: 'Mrs. Williams',
                    students: [
                        { id: 'S-006', name: 'Noah Miller' },
                        { id: 'S-007', name: 'Emma Jones' },
                        { id: 'S-008', name: 'Jackson Lee' }
                    ],
                    stats: {
                        overallTopStudent: { name: 'Emma Jones', grade: '97%' },
                        topHomeworkStudent: { name: 'Emma Jones', score: '99%' },
                        topAttendanceStudent: { name: 'Jackson Lee', rate: '98%' }
                    }
                }
            };

            // --- UI Element References ---
            const sidebar = document.getElementById('sidebar');
            const mobileMenuButton = document.getElementById('mobileMenuButton');
            
            const classListContainer = document.getElementById('classListContainer');
            const classDetailsContainer = document.getElementById('classDetailsContainer');

            const classTableBody = document.getElementById('classTableBody');
            const classSearch = document.getElementById('classSearch');
            const backToClassesButton = document.getElementById('backToClassesButton');

            // --- Functions ---
            
            // Function to display classes in the table
            function displayClasses(searchTerm = '') {
                classTableBody.innerHTML = '';
                const filteredClassIds = Object.keys(classData).filter(id => {
                    const classInfo = classData[id];
                    return classInfo.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                           classInfo.teacher.toLowerCase().includes(searchTerm.toLowerCase());
                });

                if (filteredClassIds.length === 0) {
                    classTableBody.innerHTML = '<tr><td colspan="4" class="text-center py-4">No classes found.</td></tr>';
                    return;
                }

                filteredClassIds.forEach(id => {
                    const classInfo = classData[id];
                    const row = document.createElement('tr');
                    row.className = 'border-b border-dark-border hover:bg-dark-border/50 cursor-pointer class-row';
                    row.dataset.classId = id;
                    row.innerHTML = `
                        <td class="py-3 px-4 font-medium">${classInfo.name}</td>
                        <td class="py-3 px-4 text-dark-text">${classInfo.teacher}</td>
                        <td class="py-3 px-4 text-dark-text">${classInfo.students.length}</td>
                        <td class="py-3 px-4">
                            <button class="text-brand-purple hover:underline view-details-btn" data-class-id="${id}">View Details</button>
                        </td>
                    `;
                    classTableBody.appendChild(row);
                });
            }

            // Function to switch views
            function showView(viewToShow) {
                classListContainer.classList.add('hidden');
                classDetailsContainer.classList.add('hidden');
                viewToShow.classList.remove('hidden');
            }

            // Function to show class details
            function showClassDetails(classId) {
                const selectedClass = classData[classId];
                if (!selectedClass) return;

                document.getElementById('classDetailTitle').textContent = `${selectedClass.name} Details`;
                document.getElementById('classTeacher').textContent = selectedClass.teacher;
                document.getElementById('classStudentCount').textContent = selectedClass.students.length;
                
                // Populate stats
                document.getElementById('overallTopStudentName').textContent = selectedClass.stats.overallTopStudent.name;
                document.getElementById('overallTopStudentGrade').textContent = selectedClass.stats.overallTopStudent.grade;
                document.getElementById('topHomeworkStudentName').textContent = selectedClass.stats.topHomeworkStudent.name;
                document.getElementById('topHomeworkStudentScore').textContent = selectedClass.stats.topHomeworkStudent.score;
                document.getElementById('topAttendanceStudentName').textContent = selectedClass.stats.topAttendanceStudent.name;
                document.getElementById('topAttendanceStudentRate').textContent = selectedClass.stats.topAttendanceStudent.rate;

                // Populate student list
                const studentListBody = document.getElementById('classStudentList');
                studentListBody.innerHTML = '';
                selectedClass.students.forEach(student => {
                    const tr = document.createElement('tr');
                    tr.className = 'border-b border-dark-border';
                    tr.innerHTML = `
                        <td class="py-3 px-4">${student.name}</td>
                        <td class="py-3 px-4 text-dark-text">${student.id}</td>
                    `;
                    studentListBody.appendChild(tr);
                });
                
                showView(classDetailsContainer);
            }

            // --- Event Listeners ---

            // Mobile menu toggle
            mobileMenuButton.addEventListener('click', () => {
                sidebar.classList.toggle('-translate-x-full');
            });

            // Search input
            classSearch.addEventListener('keyup', (e) => {
                displayClasses(e.target.value);
            });

            // View details button click (using event delegation)
            classTableBody.addEventListener('click', (event) => {
                if (event.target.classList.contains('view-details-btn')) {
                    const classId = event.target.dataset.classId;
                    showClassDetails(classId);
                }
            });

            // Back to class list
            backToClassesButton.addEventListener('click', () => {
                showView(classListContainer);
            });

            // --- Initial Load ---
            displayClasses();
        });
    </script>
</body>
</html>
